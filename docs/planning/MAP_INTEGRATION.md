# 지도 통합 기능 (Map Integration)

> 카카오맵 기반 지도 탐색 + 검색 병행 UI

---

## 목적

- 유저가 회식 후보 식당을 선택할 때 **지도 기반 탐색**과 **검색 기반 직접 추가** 두 가지 방식을 자유롭게 선택
- Babmoa의 핵심 가치인 "주차 데이터"를 지도 중심 UX로 자연스럽게 노출

---

## 화면 구성

### 메인 뷰 (투표 생성 페이지)
- 카카오맵 지도 영역을 화면 중심에 배치
- 초기 지도 범위는 선택된 지역 (관악 / 영등포 / 강남)
- 식당은 지도 마커로 표시

### 지역 필터
- 지도 상단에 버튼 형태로 배치
- `관악구` / `영등포구` / `강남구` 선택 가능
- 선택 시 지도 중심 및 마커 갱신

### 마커 클릭 시 Bottom Sheet
- 식당명, 주소, 카테고리
- **Babmoa 주차 뱃지**: 주차 수월 / 애매함 / 거의 불가
- 주차 성공률 및 기록 수 표시 (충분한 데이터가 있을 때)
- "카카오맵에서 보기" 링크
- "투표 후보로 추가" 버튼

### 검색 모달
- "+ 식당 검색해서 추가" 버튼으로 진입
- 카카오 장소 검색 API 사용
- 지역/카테고리 필터 적용 가능
- 검색 결과 선택 시 즉시 후보 추가

---

## 기술 구현

### 컴포넌트 구조

| 컴포넌트 | 경로 | 설명 |
|----------|------|------|
| `KakaoMap` | `/components/KakaoMap.tsx` | 카카오맵 지도 렌더링, 마커 관리 |
| `PlaceBottomSheet` | `/components/PlaceBottomSheet.tsx` | 장소 상세 정보 + 주차 뱃지 |
| `SearchModal` | `/components/SearchModal.tsx` | 검색 기반 장소 추가 |

### API 엔드포인트

| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | `/api/places/district/:district` | 지역별 장소 목록 (지도 마커용) |

### 환경 변수

```bash
# packages/client/.env
NEXT_PUBLIC_KAKAO_JS_KEY=your_kakao_js_key_here
```

> 카카오 개발자 콘솔에서 JavaScript 키 발급 필요
> https://developers.kakao.com

---

## 주차 뱃지 기준

| 뱃지 | 성공률 | 색상 |
|------|--------|------|
| 🅿️ 주차 수월 | ≥ 70% | 초록 |
| 🅿️ 애매함 | 40% ~ 69% | 노랑 |
| 🅿️ 거의 불가 | < 40% | 빨강 |
| ☁️ 주차 정보 부족 | 기록 < 3건 | 회색 |

---

## UX 원칙

1. **지도 탐색을 기본 경험**으로 제공
2. **검색은 목적형 유저를 위한 보조 수단**으로 제공
3. 지도 UI를 검색창으로 가리지 않음
4. Babmoa 주차 데이터는 항상 카카오 정보보다 시각적으로 구분되게 표시
5. **Babmoa 전용 정보임을 명시** ("참고용" 라벨)

---

## MVP 범위 제한

- ❌ 리뷰, 사진, 메뉴 정보 제공하지 않음
- ❌ 카카오 데이터 직접 노출 (링크 이동 중심)
- ✅ 주차 데이터는 요약 뱃지 + 기준 설명까지만 제공
- ❌ 고급 필터, 정렬 기능은 MVP 범위에서 제외

---

## 관련 문서

| 문서 | 내용 |
|------|------|
| [UX_FLOW.md](./UX_FLOW.md) | 전체 사용자 흐름 |
| [ARCHITECTURE.md](./ARCHITECTURE.md) | 기술 스택, API 명세 |
| [DATABASE.md](./DATABASE.md) | 주차 데이터 스키마 |
