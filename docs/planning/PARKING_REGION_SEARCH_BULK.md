# Parking Region Search & Bulk Info API Specification

## 1. 목적

전국 검색 기능과 주차 정보 표시 정책을 동시에 구현하기 위한 명세.
검색은 전국, 주차 정보 노출은 대구·경산 CORE_REGION만 적용.
Bulk Info API는 CORE_REGION 여부를 확인하고 효율적으로 뱃지를 표시하기 위해 사용.

---

## 2. 검색 기능 (전국)

### 2.1 요청
- **범위**: 사용자가 장소를 검색할 때 전국 범위에서 검색 가능
- **방식**: 카카오맵 API 호출 또는 내부 검색 DB 사용

### 2.2 Response 예시
```json
[
  { "placeId": "A123", "name": "서울 강남 음식점", "address": "서울 강남구 ..." },
  { "placeId": "B456", "name": "대구 동성로 카페", "address": "대구 중구 ..." }
]
```

### 2.3 UI/UX
- 검색 결과는 모든 지역 노출
- CORE_REGION 여부와 관계없이 선택 가능
- 주차 뱃지는 검색 결과 리스트에 바로 표시하지 않음 (상세 정보는 Bulk Info API로 확인)

---

## 3. Bulk Info API

### 3.1 목적
- 지도에 여러 마커 표시 시 각 장소의 주차 정보와 지역 상태 확인
- 비효율적인 개별 호출 방지

### 3.2 요청
**POST** `/api/places/bulk-info`
**Content-Type**: `application/json`

```json
{
  "places": [
    { "placeId": "A123", "address": "서울 강남구 ..." },
    { "placeId": "B456", "address": "대구 중구 ..." }
  ]
}
```

### 3.3 응답
- `CORE_REGION`인 경우만 `parkingInfo` 포함
- Non-CORE 지역은 주차 정보 필드 자체 제거

```json
{
  "results": [
    {
      "placeId": "A123",
      "regionStatus": "OPEN",
      "parkingInfo": null  // 필드 제거
    },
    {
      "placeId": "B456",
      "regionStatus": "CORE",
      "parkingInfo": {
        "badge": true,
        "successRate": 92
      }
    }
  ]
}
```

---

## 4. 지도 마커 표시 로직

### 4.1 기본 동작
- **지도 마커 표시**: 전국 표시 (검색 + 추천)
- **첫 로딩**: 현재 위치 기준 주변 마커 우선 표시

### 4.2 Bulk Info API 호출 후
- **CORE_REGION**: 주차 뱃지 표시, 통계 노출
- **Non-CORE REGION**: 뱃지 미노출, 상세 정보 클릭 시 “주차 정보 부족” 안내

### 4.3 필터 동작
- **기존 필터 버튼 제거**: 사용자 혼란을 방지하기 위해 지도 상의 지역 필터 버튼을 제거함.
- **자동 노출**: 별도 필터 조작 없이, 지도를 이동하거나 검색했을 때 CORE_REGION에 해당하면 자동으로 주차 뱃지가 표시됨.

### 4.4 클라이언트 보조 판별 (Hybrid Check)
- API 응답 대기 시간을 최소화하기 위해, 클라이언트(App)에서도 주소 텍스트 기반으로 `CORE_REGION` 포함 여부(예: '대구', '경산')를 1차 판별할 수 있음.
- 이를 통해 검색 직후나 마커 클릭 시 즉각적인 UI 반영(뱃지 표시 또는 안내 문구)을 지원함.

---

## 5. UX 원칙

### 5.1 기본 원칙
- **검색은 자유**: 전국 어디서나 검색 가능
- **데이터 수집은 독립**: 정보 제공 여부와 관계없이 수집은 가능
- **주차 정보는 정책 준수**: 대구·경산 등 CORE_REGION에서만 노출

### 5.2 UI 고정 문구
사용자가 정보 부족으로 혼동하지 않도록 아래 문구를 고정으로 사용.
> "주차 정보는 실제 방문 기록을 기반으로 제공되며, 지역 및 장소에 따라 표시되지 않을 수 있습니다."

---

## 6. 요약

| 구분 | 동작 |
|---|---|
| **검색** | 전국, 모든 장소 노출 |
| **지도 마커** | 전국 표시, CORE_REGION만 주차 뱃지 |
| **Bulk Info API** | CORE 여부 확인 + 주차 정보 제공 |
| **Non-CORE 지역** | parkingInfo 필드 제거, 클릭 시 안내 문구 표시 |
| **첫 로딩** | 현재 위치 주변 마커 우선 |
| **기존 필터** | 제거, CORE 전용 필터 선택 시 적용 가능 |
